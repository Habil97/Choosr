@model Choosr.Domain.Models.UserProfile
@{ViewData["Title"]="≈ûifre Deƒüi≈ütir";}
<div class="profile-layout">
  <aside class="profile-sidebar">
    <div class="profile-card">
  <div class="avatar-lg"><img src="@(Model.AvatarUrl??"/img/anon-avatar.svg")" alt=""/></div>
      <div class="profile-names">
        <div class="prof-handle">@Model.UserName</div>
      </div>
    </div>
    <nav class="profile-menu">
      <a class="menu-item" asp-controller="Profile" asp-action="Edit">‚öô Profil D√ºzenle</a>
      <a class="menu-item active" asp-controller="Profile" asp-action="ChangePassword">üîí ≈ûifre Deƒüi≈ütir</a>
      <form asp-controller="Account" asp-action="Logout" method="post" class="menu-item m-0 p-0">
        <button type="submit" class="menu-item btn-logout">‚Ü© √áƒ±kƒ±≈ü</button>
      </form>
    </nav>
  </aside>
  <section class="profile-content">
    <a asp-action="Index" class="back-link">‚Üê Geri</a>
    <h1 class="profile-title">≈ûifre Deƒüi≈ütir</h1>
    <p class="profile-sub">≈ûifrenizi deƒüi≈ütirin</p>
    @if(TempData["Msg"]!=null){<div class="alert alert-success">@TempData["Msg"]</div>}
    @if(!ViewData.ModelState.IsValid){<div class="alert alert-danger small">@string.Join(" ", ViewData.ModelState.Values.SelectMany(v=>v.Errors).Select(e=>e.ErrorMessage))</div>}
  <form method="post" class="profile-form vstack gap-3" autocomplete="off">
      <div class="position-relative">
        <label class="form-label">Mevcut ≈ûifre</label>
        <input name="CurrentPassword" type="password" class="form-control" placeholder="Mevcut ≈ûifre" data-pass />
        <button class="show-pass-btn" type="button" data-toggle-pass></button>
      </div>
      <div class="position-relative">
        <label class="form-label">≈ûifre</label>
        <input name="Password" type="password" class="form-control" placeholder="≈ûifre" data-pass />
        <button class="show-pass-btn" type="button" data-toggle-pass></button>
      </div>
      <div class="position-relative">
        <label class="form-label">≈ûifreyi Onayla</label>
        <input name="PasswordConfirm" type="password" class="form-control" placeholder="≈ûifreyi Onayla" data-pass />
        <button class="show-pass-btn" type="button" data-toggle-pass></button>
      </div>
      <div class="mt-3">
        <button class="btn btn-success auth w-100" type="submit">Kaydet</button>
      </div>
    </form>
  @{ var cfg = Context.RequestServices.GetService(typeof(IConfiguration)) as IConfiguration; var siteKey = cfg?["Turnstile:SiteKey"] ?? cfg?["Cloudflare:Turnstile:SiteKey"]; var enable = (cfg?["Captcha:RequireOn:ChangePassword"] ?? "false").ToLowerInvariant()=="true"; }
  @if(enable && !string.IsNullOrWhiteSpace(siteKey)){
    <div class="mt-2"><div class="cf-turnstile" data-sitekey="@siteKey"></div></div>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  }
  </section>
</div>